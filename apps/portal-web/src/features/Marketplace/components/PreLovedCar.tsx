import { motion } from "framer-motion";
import type { Vehicle } from "../services/serviceMarketplace";

interface PreLovedCarProps {
  vehicle: Vehicle;
  onClick?: () => void;
}

const IconCalendarSmall = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="14"
    height="14"
    viewBox="0 0 14 14"
    fill="none"
  >
    <rect
      x="1.64233"
      y="3.28467"
      width="9.85401"
      height="8.21168"
      rx="1.31387"
      stroke="white"
      stroke-width="1.31387"
    />
    <path
      d="M1.64233 5.47445C1.64233 4.65581 1.64233 4.24649 1.81836 3.9416C1.93368 3.74187 2.09954 3.57601 2.29927 3.46069C2.60415 3.28467 3.01347 3.28467 3.83211 3.28467H9.30657C10.1252 3.28467 10.5345 3.28467 10.8394 3.46069C11.0391 3.57601 11.205 3.74187 11.3203 3.9416C11.4963 4.24649 11.4963 4.65581 11.4963 5.47445H1.64233Z"
      fill="white"
    />
    <path
      d="M3.83191 1.64233L3.83191 3.28467"
      stroke="white"
      stroke-width="1.31387"
      stroke-linecap="round"
    />
    <path
      d="M9.30676 1.64233L9.30676 3.28467"
      stroke="white"
      stroke-width="1.31387"
      stroke-linecap="round"
    />
    <rect
      x="3.83191"
      y="6.56934"
      width="2.18978"
      height="1.09489"
      rx="0.328467"
      fill="white"
    />
    <rect
      x="3.83191"
      y="8.75952"
      width="2.18978"
      height="1.09489"
      rx="0.328467"
      fill="white"
    />
    <rect
      x="7.11658"
      y="6.56934"
      width="2.18978"
      height="1.09489"
      rx="0.328467"
      fill="white"
    />
    <rect
      x="7.11658"
      y="8.75952"
      width="2.18978"
      height="1.09489"
      rx="0.328467"
      fill="white"
    />
  </svg>
);

const IconDollarSimple = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="9"
    height="10"
    viewBox="0 0 9 10"
    fill="none"
  >
    <path
      d="M4.36781 7.43487C4.31 7.30785 4.19028 7.21517 4.04539 7.1987C3.92269 7.18469 3.80256 7.15841 3.68833 7.1205C3.63711 7.10328 3.58905 7.08447 3.54455 7.06432L3.61848 6.86278C3.67069 6.88609 3.72448 6.9074 3.77955 6.92667L3.78183 6.92749L3.78416 6.92825C3.96088 6.98665 4.1348 7.01626 4.30095 7.01626C4.46779 7.01626 4.58874 6.99389 4.68165 6.94595L4.6872 6.94308L4.69263 6.93993C4.83338 6.85916 4.91415 6.72035 4.91415 6.55899C4.91415 6.37993 4.81755 6.23131 4.64907 6.15101C4.56433 6.10978 4.44397 6.07041 4.27058 6.02731C4.09275 5.98235 3.94336 5.93463 3.8275 5.88575C3.74282 5.84744 3.66935 5.7863 3.60312 5.69887C3.54613 5.62085 3.51728 5.50352 3.51728 5.34999C3.51728 5.16475 3.56943 5.01186 3.67677 4.88256C3.77231 4.76926 3.90797 4.69229 4.09006 4.64913C4.22514 4.61713 4.3305 4.52071 4.37786 4.3962C4.43141 4.5224 4.54535 4.61625 4.68714 4.63885C4.80558 4.65772 4.91432 4.68779 5.01208 4.7285L4.94405 4.92601C4.75944 4.8519 4.57776 4.81446 4.40204 4.81446C3.81844 4.81446 3.78889 5.21707 3.78889 5.29778C3.78889 5.47275 3.88339 5.61945 4.04813 5.70033L4.05275 5.70261L4.05742 5.70471C4.14064 5.74185 4.25872 5.77765 4.42913 5.81737C4.60533 5.85719 4.75226 5.90281 4.86772 5.95338L4.87011 5.95443L4.87251 5.95542C4.95824 5.99111 5.03176 6.05067 5.09729 6.13757L5.09834 6.13892L5.09939 6.14032C5.15668 6.21437 5.18576 6.32889 5.18576 6.48073C5.18576 6.65599 5.13501 6.80433 5.0306 6.93427C4.94002 7.04698 4.81358 7.125 4.64393 7.17277C4.51294 7.20968 4.41132 7.30984 4.36781 7.43487Z"
      fill="#C4C9CD"
    />
    <path
      d="M4.51557 7.95936H4.23437C4.17147 7.95936 4.12049 7.90709 4.12049 7.84256V7.60809C4.12049 7.54642 4.07371 7.49572 4.01391 7.48889C3.87153 7.47271 3.73382 7.44252 3.60073 7.39837C3.47143 7.35481 3.35941 7.30318 3.26468 7.24332C3.22114 7.21581 3.2053 7.15998 3.2233 7.11093L3.41619 6.58498C3.44217 6.5142 3.52598 6.4871 3.59051 6.52372C3.67764 6.57306 3.77132 6.61529 3.87141 6.65033C4.02063 6.69962 4.16382 6.72426 4.30095 6.72426C4.41885 6.72426 4.50313 6.71124 4.55364 6.68513C4.60416 6.65611 4.62945 6.61406 4.62945 6.55899C4.62945 6.49522 4.59575 6.44739 4.52835 6.4155C4.46341 6.38361 4.35508 6.34881 4.20353 6.31114C4.00859 6.26185 3.84618 6.20964 3.71624 6.15457C3.5863 6.09658 3.47318 6.00378 3.37694 5.87623C3.28067 5.74577 3.23255 5.57033 3.23255 5.34999C3.23255 5.09484 3.30836 4.87596 3.45993 4.69328C3.59658 4.53128 3.78521 4.42172 4.02594 4.36467C4.08013 4.35182 4.12049 4.30358 4.12049 4.24658V3.98816C4.12049 3.92363 4.17147 3.87136 4.23437 3.87136H4.51557C4.57846 3.87136 4.62945 3.92363 4.62945 3.98816V4.23181C4.62945 4.29149 4.67336 4.34119 4.73083 4.35036C4.94171 4.38394 5.12701 4.44754 5.28668 4.54115C5.332 4.56772 5.34998 4.62425 5.33258 4.67471L5.15207 5.1985C5.12818 5.26794 5.04847 5.29731 4.98434 5.26414C4.78099 5.15902 4.58693 5.10646 4.40204 5.10646C4.18304 5.10646 4.07354 5.17024 4.07354 5.29778C4.07354 5.35869 4.10606 5.40506 4.17101 5.43701C4.236 5.46597 4.34305 5.49786 4.49226 5.53267C4.68475 5.57617 4.84722 5.62687 4.97955 5.68486C5.11189 5.73993 5.22618 5.83127 5.32248 5.95887C5.42112 6.08642 5.47046 6.26039 5.47046 6.48073C5.47046 6.72426 5.39705 6.93736 5.25024 7.12004C5.1224 7.27924 4.94539 7.39066 4.71932 7.45438C4.66735 7.46904 4.62945 7.51622 4.62945 7.57147V7.84256C4.62945 7.90709 4.57846 7.95936 4.51557 7.95936Z"
      fill="#C4C9CD"
    />
    <path
      d="M5.5875 0C5.71297 0 5.84089 0.0241396 5.95755 0.0882529C6.0771 0.153959 6.16355 0.250118 6.22016 0.358752C6.32495 0.559876 6.32194 0.791878 6.29926 0.972934C6.25239 1.34703 6.08182 1.78092 5.95396 2.07735L5.81423 2.40346C5.95525 2.44599 6.0907 2.50759 6.21657 2.5875L6.27235 2.62463L6.29406 2.64077C6.30104 2.64642 6.30777 2.65238 6.31433 2.65853C7.2042 3.49363 7.92604 4.49859 8.43939 5.61662C8.65761 6.07076 8.74465 6.57852 8.6916 7.08086C8.62013 8.38262 7.5984 9.43237 6.30841 9.49436C6.30256 9.49464 6.29668 9.49472 6.29083 9.49472H2.41882C2.41314 9.49472 2.40746 9.49463 2.40178 9.49436C1.11092 9.43421 0.0872096 8.38478 0.0150073 7.08212C-0.0380622 6.57771 0.0501945 6.06781 0.270618 5.61231C0.78436 4.4959 1.50592 3.4924 2.39532 2.65853L2.41559 2.64077C2.4226 2.63511 2.42989 2.62976 2.4373 2.62463C2.57855 2.52666 2.73307 2.45235 2.89507 2.40346L2.75515 2.07628C2.62815 1.78045 2.45763 1.34688 2.41057 0.973293C2.38778 0.792356 2.38444 0.560174 2.48914 0.358931C2.54572 0.250211 2.63232 0.153982 2.75192 0.0882529C2.86861 0.0241336 2.9965 9.99274e-06 3.12198 0H5.5875ZM3.13453 0.734723C3.13171 0.763328 3.1306 0.810333 3.13955 0.881453C3.17232 1.14161 3.30302 1.49005 3.4305 1.78694L3.71553 2.45314L3.76055 2.5579C3.81076 2.6744 3.79738 2.80867 3.72504 2.91288C3.6527 3.01707 3.53171 3.07649 3.40503 3.0702C3.21983 3.06098 3.03578 3.1108 2.87802 3.21352C2.06605 3.97967 1.40597 4.90059 0.935205 5.92568C0.93418 5.92791 0.933046 5.93011 0.931977 5.93232C0.779984 6.24639 0.713832 6.59705 0.740224 6.94669L0.746681 7.01664L0.748296 7.03745C0.798538 7.97911 1.53245 8.71548 2.43084 8.76H6.27809C7.1763 8.71426 7.90906 7.97718 7.95831 7.03566L7.9601 7.01431C8.00145 6.64171 7.93689 6.265 7.77481 5.92999C7.77373 5.92776 7.77261 5.92542 7.77158 5.92317C7.30138 4.89915 6.64218 3.97925 5.83145 3.21352C5.67378 3.11086 5.48982 3.06098 5.30462 3.0702C5.17804 3.0765 5.05717 3.0171 4.98479 2.91306C4.91244 2.80903 4.89881 2.67509 4.94874 2.55862L5.27879 1.7873L5.27933 1.7864C5.40714 1.49008 5.53771 1.14158 5.57028 0.881632C5.5792 0.81038 5.57817 0.763319 5.5753 0.734723H3.13453Z"
      fill="#C4C9CD"
    />
  </svg>
);

const IconGear = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="8"
    height="8"
    viewBox="0 0 8 8"
    fill="none"
  >
    <path
      opacity="0.99"
      d="M1.31421 0C1.63398 3.55378e-06 1.94243 0.116741 2.18237 0.328125C2.42232 0.539523 2.57763 0.831199 2.61792 1.14844C2.65807 1.46539 2.58132 1.7863 2.4021 2.05078C2.22262 2.31545 1.95197 2.50599 1.64233 2.58594V3.66895C1.74778 3.63142 1.85951 3.61227 1.97144 3.6123H5.58472C5.67167 3.61219 5.75467 3.57712 5.81616 3.51562C5.87766 3.45413 5.91272 3.37113 5.91284 3.28418V2.58594C5.67507 2.52454 5.45915 2.39755 5.28979 2.21973C5.12046 2.04182 5.00448 1.81964 4.95483 1.5791C4.90525 1.3386 4.92348 1.08875 5.00854 0.858398C5.09371 0.62801 5.24216 0.425889 5.43628 0.275391C5.63039 0.124955 5.86288 0.0318912 6.10718 0.00683594C6.3516 -0.0181599 6.59844 0.0257095 6.81909 0.133789C7.03975 0.241878 7.22612 0.409712 7.3562 0.618164C7.4861 0.826433 7.55522 1.06704 7.55542 1.3125C7.55514 1.60361 7.45814 1.88694 7.28003 2.11719C7.10178 2.34742 6.85186 2.51267 6.57007 2.58594V3.28418C6.56995 3.54536 6.4657 3.79578 6.28101 3.98047C6.09631 4.16516 5.8459 4.26941 5.58472 4.26953H1.97144C1.88438 4.26953 1.8006 4.30371 1.73901 4.36523C1.67741 4.42683 1.64233 4.51054 1.64233 4.59766V5.2959C1.95197 5.37585 2.22262 5.56541 2.4021 5.83008C2.58156 6.09474 2.65821 6.41618 2.61792 6.7334C2.57761 7.05061 2.4223 7.34233 2.18237 7.55371C1.94247 7.76496 1.63387 7.88183 1.31421 7.88184C0.994549 7.88184 0.685952 7.76495 0.446045 7.55371C0.206114 7.34233 0.0508054 7.05061 0.010498 6.7334C-0.0297949 6.41617 0.0468546 6.09474 0.226318 5.83008C0.405797 5.56541 0.676452 5.37585 0.986084 5.2959V2.58594C0.676452 2.50599 0.405797 2.31545 0.226318 2.05078C0.0470927 1.7863 -0.0296545 1.46539 0.010498 1.14844C0.0507926 0.831199 0.206098 0.539523 0.446045 0.328125C0.685987 0.116747 0.994438 0 1.31421 0ZM1.31421 5.91113C1.18428 5.91113 1.05701 5.95028 0.948975 6.02246C0.841086 6.09463 0.756463 6.19745 0.706787 6.31738C0.657273 6.4372 0.644446 6.56912 0.669678 6.69629C0.695024 6.82372 0.757499 6.94133 0.849365 7.0332C0.941239 7.12508 1.05885 7.18754 1.18628 7.21289C1.31345 7.23813 1.44537 7.2253 1.56519 7.17578C1.68512 7.1261 1.78793 7.04149 1.86011 6.93359C1.93229 6.82556 1.97144 6.69829 1.97144 6.56836C1.97142 6.39415 1.90224 6.2267 1.77905 6.10352C1.65586 5.98033 1.48843 5.91114 1.31421 5.91113ZM1.44214 0.668945C1.31488 0.643661 1.18313 0.656472 1.06323 0.706055C0.943193 0.755776 0.840495 0.84021 0.768311 0.948242C0.696223 1.05615 0.657067 1.18274 0.656982 1.3125C0.656982 1.48663 0.726296 1.65416 0.849365 1.77734C0.972564 1.90054 1.13998 1.96973 1.31421 1.96973C1.44413 1.96972 1.57142 1.93156 1.67944 1.85938C1.78735 1.78725 1.87093 1.68434 1.92065 1.56445C1.97038 1.44441 1.98409 1.312 1.95874 1.18457C1.9334 1.05732 1.87074 0.94043 1.77905 0.848633C1.68718 0.756759 1.56957 0.694293 1.44214 0.668945ZM6.11304 0.668945C5.98567 0.694293 5.86894 0.756828 5.7771 0.848633C5.68525 0.940482 5.6218 1.05718 5.59644 1.18457C5.57109 1.312 5.5848 1.44441 5.63452 1.56445C5.68425 1.68441 5.76873 1.78723 5.87671 1.85938C5.98458 1.93133 6.11129 1.96968 6.24097 1.96973C6.4152 1.96973 6.58261 1.90054 6.70581 1.77734C6.82895 1.65415 6.89819 1.48668 6.89819 1.3125C6.89811 1.18288 6.85978 1.05607 6.78784 0.948242C6.71572 0.840298 6.61283 0.755792 6.49292 0.706055C6.37288 0.656333 6.24047 0.643597 6.11304 0.668945Z"
      fill="white"
    />
  </svg>
);

export const PreLovedCar = ({ vehicle, onClick }: PreLovedCarProps) => {
  const formatPrice = (price: number) => {
    return new Intl.NumberFormat("es-GT", {
      style: "currency",
      currency: "GTQ",
      minimumFractionDigits: 0,
    }).format(price);
  };

  return (
    <motion.div
      className="relative cursor-pointer group h-56 "
      whileHover={{ scale: 1.05 }}
      transition={{ duration: 0.3 }}
      onClick={onClick}
    >
      {/* Imagen del vehículo */}
      <div className="w-full h-full relative overflow-hidden rounded-3xl">
        <img
          src={vehicle.images[0]?.url}
          alt={`${vehicle.marca} ${vehicle.linea}`}
          className="w-full h-full object-cover"
        />

        {/* Overlay oscuro en hover */}
        <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
      </div>

      {/* Card de información */}
      <div
        className="absolute bottom-2 left-1/2 transform -translate-x-1/2 p-2 transition-all duration-300 rounded-4xl bg-dark/75"
        style={{
          boxShadow: "0 2.628px 2.628px 0 rgba(0, 0, 0, 0.25)",
          width: "calc(100% - 16px)",
        }}
      >
        {/* Acción "Ver más" - visible solo en hover arriba */}
        <div className="max-h-0 opacity-0 overflow-hidden group-hover:max-h-8 group-hover:opacity-100 transition-all duration-300">
          <div className="pb-2 text-center">
            <span className="text-primary text-sm font-medium cursor-pointer  transition-colors">
              Ver más
            </span>
          </div>
        </div>

        {/* Información básica - siempre visible */}
        <div className="flex flex-col justify-between items-center">
          {/* Marca y línea */}
          <h3 className="text-white text-base">
            {vehicle.marca} {vehicle.linea}
          </h3>

          {/* Grid de información con iconos */}
          <div className="grid grid-cols-3 gap-2 text-xs items-center justify-center">
            {/* Año */}
            <div className="flex items-center gap-1 text-white/70 justify-center">
              <div>
                <IconCalendarSmall />
              </div>
              <span>{vehicle.modelo}</span>
            </div>

            {/* Precio */}
            <div className="flex items-center gap-1 text-white/70 justify-center">
              <div>
                <IconDollarSimple />
              </div>
              <span className="truncate">{formatPrice(vehicle.precio)}</span>
            </div>

            {/* Transmisión */}
            <div className="flex items-center gap-1 text-white/70 justify-center">
              <div>
                <IconGear />
              </div>
              <span className="capitalize">{vehicle.transmision}</span>
            </div>
          </div>
        </div>
      </div>

      {/* Badge de nuevo/usado */}
      <div className="absolute top-4 right-4">
        <div
          className={`px-3 py-1 rounded-full text-xs font-semibold ${
            vehicle.nuevo
              ? "bg-green-500/90 text-white"
              : "bg-blue-500/90 text-white"
          }`}
        >
          {vehicle.nuevo ? "Nuevo" : "Usado"}
        </div>
      </div>
    </motion.div>
  );
};
